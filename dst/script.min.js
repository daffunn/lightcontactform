/*!
 * @author: Jan Wolf (https://jan-wolf.de)
 * @license: 2016 Jan Wolf
 */
!function($){"use strict";var jw_lighttwitterwidget=function(options){if(options=$.extend(!0,{element:null,selectors:{name:"[data-name]",mail:"[data-mail]",snippet:"[data-snippet]",submit:"[data-submit]"},attributes:{snippet:"data-snippet",snippet_order:"data-snippet-order"},attribute_functions:{snippet:{value:"value()",newline:"newline()"}},callbacks:{fire:function(){},sent:function(){},error:function(){}}},options||{}),null===options.element||options.element.length>1)throw"Multiple or no element set as a widget container.";var prefix=function(e){return options.element.attr("data-prefix")+"_"+e},reset=function(){options.element.find([options.selectors.mail,options.selectors.name,options.selectors.snippet].join(",")).val("")};options.element.on(prefix("submit_event"),function(){if(!options.element.hasClass("pending")){options.element.removeClass("error success").addClass("pending"),options.callbacks.fire(options.element);var fail=function(){options.element.addClass("error"),options.callbacks.error(options.element)},ajaxobj=eval(prefix("ajaxobj"));$.ajax({url:ajaxobj.ajaxurl,cache:!1,type:"POST",data:{action:prefix("api"),name:options.element.find(options.selectors.name).eq(0).val(),mail:options.element.find(options.selectors.mail).eq(0).val(),message:function(){var e=[];return options.element.find(options.selectors.snippet).each(function(){var t=$(this).attr(options.attributes.snippet);t=void 0===t||0==t.length?$(this).val():t.replace(options.attribute_functions.snippet.value,$(this).val()),t.replace(options.attribute_functions.snippet.newline,"\n");var n=parseInt($(this).attr(options.attributes.snippet_order));isNaN(n)?e.push(t):e[n]=t}),e.join("\n")}(),nonce:ajaxobj.nonce},dataType:"json",beforeSend:function(e){e&&e.overrideMimeType&&e.overrideMimeType("application/json;charset=UTF-8")}}).always(function(){options.element.removeClass("pending")}).fail(fail).done(function(e){return e.success?(options.element.addClass("success"),options.callbacks.sent(options.element),void reset()):void fail()})}}),options.element.find(options.selectors.submit).not('[data-submit="silent"]').click(function(){options.element.trigger(prefix("submit_event"))})};$(document).ready(function(){$(".jw_lightcontactform_widget").each(function(){new jw_lighttwitterwidget({element:$(this)})})})}(jQuery);