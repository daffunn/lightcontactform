/*!
 * @author: Jan Wolf (https://jan-wolf.de)
 * @license: 2016 Jan Wolf
 */
!function($){"use strict";$.fn.jwLightContactForm=function(options){options=$.extend(!0,{prefix:"jw_lightcontactform",selectors:{name:"[data-name]",mail:"[data-mail]",snippet:"[data-snippet]",submit:"[data-submit]"},attributes:{snippet:"data-snippet",snippet_order:"data-snippet-order"},attribute_functions:{snippet:{value:"value()",newline:"newline()"}},callbacks:{fire:function(){},sent:function(){},error:function(){}}},options||{});var prefix=function(t){return options.prefix+"_"+t};return this.each(function(){var widget=$(this);widget.on(prefix("submit_event"),function(){if(!widget.hasClass("pending")){widget.removeClass("error success").addClass("pending"),options.callbacks.fire(widget);var fail=function(){widget.addClass("error"),options.callbacks.error(widget)},ajax_obj=eval(prefix("ajaxobj"));$.ajax({url:ajax_obj.endpoint_url,cache:!1,type:"POST",data:{action:ajax_obj.endpoint_action,nonce:ajax_obj.endpoint_nonce,name:widget.find(options.selectors.name).eq(0).val(),mail:widget.find(options.selectors.mail).eq(0).val(),message:function(){var t=[];return widget.find(options.selectors.snippet).each(function(){var e=$(this).attr(options.attributes.snippet);e=void 0===e||0==e.length?$(this).val():e.replace(options.attribute_functions.snippet.value,$(this).val()),e.replace(options.attribute_functions.snippet.newline,"\n");var i=parseInt($(this).attr(options.attributes.snippet_order));isNaN(i)?t.push(e):t[i]=e}),t.join("\n")}()},dataType:"json",beforeSend:function(t){t&&t.overrideMimeType&&t.overrideMimeType("application/json;charset=UTF-8")}}).always(function(){widget.removeClass("pending")}).fail(fail).done(function(t){return t.success?(widget.addClass("success"),options.callbacks.sent(widget),void widget.find([options.selectors.mail,options.selectors.name,options.selectors.snippet].join(",")).val("")):void fail()})}}),widget.find(options.selectors.submit).not('[data-submit="silent"]').click(function(){widget.trigger(prefix("submit_event"))})})},$(document).ready(function(){eval("jw_lightcontactform_ajaxobj").autoload&&$(".jw_lightcontactform_widget").jwLightContactForm()})}(jQuery);